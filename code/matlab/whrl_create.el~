 (defun get-html-file-title (fName -beg -end)
    "Return FNAME <title> tag's text.
  Assumes that the file contains the string
  “<title>…</title>”."
					;Source: http://ergoemacs.org/emacs/elisp_link_report.html <2017-02-28 Tue>
    (with-temp-buffer
      (insert-file-contents fName nil nil nil t)
      (goto-char 1)
      (buffer-substring-no-properties
       (search-forward -beg) (- (search-forward -end) 1))
      ))

 (defun whrl-modify-html-file (fName -beg -end -replace)
    "Return FNAME <title> tag's text.
  Assumes that the file contains the string
  “<title>…</title>”."
					;Source: http://ergoemacs.org/emacs/elisp_link_report.html <2017-02-28 Tue>
(save-excursion
    (find-file fName)

      (goto-char 1)
      (delete-region
       (- (search-forward -beg) (length -beg)) (- (search-forward -end) 0))
      (insert -replace )
	      
(save-buffer)
(kill-buffer)
)
)


(defun whrl-create-html-table ()
  (setq -fileDir "c:/users/tw/Dropbox/lib/matlab_whrl/")
  (setq -fileReg "\\.html$")
  (setq -fileTableName "index.html")
					;  (setq -fileList (find-lisp-find-files -fileDir -fileReg))
  (setq -htmlHeader "<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<title></title>\n<meta  name=\"author\" content=\"T. Wöhrl\" />\n<link rel=\"stylesheet\" type=\"text/css\" href=\"theme.css\"/>")
  (setq -fileList (directory-files -fileDir t ".html$"))
  (setq -reg '("\n% created on:" "\n% info:" "function"  ))
  (setq -tableHeading '("Link" "Created on"  "Shortinfo" "Function"))
  (setq -tableClosing)
  (setq -filePreamble "<html>")
  (setq -filePostamble "</html>")
  (save-excursion
    (find-file (concat -fileDir -fileTableName))
    (erase-buffer)
    (insert -filePreamble)  
    (insert "<table><tr>")
    (while -tableHeading
      (insert "<th>")
      (insert (pop -tableHeading))
      (insert "</th>")
      )
    (insert "</tr>")
    
    (while -fileList
      (setq -fileName (pop -fileList))
      (whrl-modify-html-file -fileName "<head" "</head>" -htmlHeader)
      (whrl-modify-html-file -fileName "<p class=\"footer\">" "</body>" "</body>")
      (insert "<tr>")
      (insert " <td> ")
      (insert (file-name-nondirectory -fileName))
      (insert " </td>")
      
      
      (dotimes (i (length -reg))
	(insert " <td> ")
	(ignore-errors

	  (insert (get-html-file-title -fileName (nth i -reg) "\n"))
	  )
	(insert "</td>")      
	)
      (insert "</tr>")
      )
    (insert "</table>")
    (insert -filePostamble)
    (save-buffer)
    (kill-buffer)
    )
  (browse-url "index.html")
  )
(whrl-create-html-table)
